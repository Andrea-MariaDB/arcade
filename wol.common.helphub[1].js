//
// Copyright (c) Microsoft Corporation.  All rights reserved.
//

function processDocumentLoaded(){var n=jQuery(".feedbackRatingButton:disabled"),t;if(n)for(t=0;t<n.length;t++)n[t].removeAttribute("disabled");jQuery(".feedbackCommentVerboseText").bind("paste",processVerboseFeedbackPaste)}function processRatingExplanationClick(n){window.open(n)}function processRatingClick(n,t,i,r,u,f){var e,o,s;if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}return wolFeedbackId=createFeedbackId(),Wol.ContentInstrumentation.Logging.LogCustomBI("Rating",{Rating:n,FeedbackId:wolFeedbackId}),e=jQuery("#"+t)[0],o=jQuery("#"+i)[0],n=="0"?(jQuery("#"+r)[0].innerHTML=jQuery("#commentNoPrompt")[0].innerHTML,jQuery("#"+u)[0].value=jQuery("#commentNoYesString")[0].innerHTML,jQuery("#"+f)[0].value=jQuery("#commentNoNoString")[0].innerHTML):n=="0.5"&&(jQuery("#"+r)[0].innerHTML=jQuery("#commentSomewhatPrompt")[0].innerHTML,jQuery("#"+u)[0].value=jQuery("#commentSomewhatYesString")[0].innerHTML,jQuery("#"+f)[0].value=jQuery("#commentSomewhatNoString")[0].innerHTML),e.style.display="none",o.style.display="block",s=jQuery("#commentVerboseText")[0],s.focus(),!1}function processVerboseFeedbackKeyUp(){processTextChange()}function processVerboseFeedbackChange(){processTextChange()}function processVerboseFeedbackFocus(){processTextChange()}function processVerboseFeedbackPaste(){window.setTimeout(processTextChange,200)}function processTextChange(){var f=5,n=jQuery("#commentVerboseText")[0],e=parseInt(jQuery("#commentMaxSize")[0].innerHTML),s=parseInt(jQuery("#commentMaxEncodedSize")[0].innerHTML);n.value.length>e&&(n.value=n.value.substr(0,e));var t=escape(n.value),h=t.length,i=s-f;if(h>i){var r=t.substr(0,i),u=t.substr(i,f),o=u.lastIndexOf("%"),c;r+=o==-1?u:u.substr(0,o),n.value=unescape(r)}}function processCommentClick(n,t,i){var r,u,f;if(!Wol.ContentInstrumentation||!Wol.ContentInstrumentation.Logging){Sys.Debug.assert(!1,"ContentInstrumentation library is not available",!0);return}return r=jQuery("#commentVerboseText")[0],n=="1"&&r.value.length>0&&Wol.ContentInstrumentation.Logging.LogCustomBI("Feedback",{Verbatim:r.value,FeedbackId:wolFeedbackId}),u=jQuery("#"+t)[0],f=jQuery("#"+i)[0],u.style.display="none",f.style.display="block",!1}function createRandomFourDigitHex(){var n=Math.floor(Math.random()*65536).toString(16),t=n.length;return t==4||(n=t==3?"0"+n:t==2?"00"+n:"000"+n),n}function createFeedbackId(){return createRandomFourDigitHex()+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+"-"+createRandomFourDigitHex()+createRandomFourDigitHex()+createRandomFourDigitHex()}function onPlayerCaptionsActivated_Logging(n){var t=Wol.Video.GetPlayerElementFromScriptableName(n);t&&t.onPlayerCaptionsActivated&&t.onPlayerCaptionsActivated()}var link_expandAllText,link_collapseAllText,wolFeedbackId,SearchBoxPostProcessEvent,FeedbackControlPolicyPostProcessEvent;Type.registerNamespace("Wol.Util"),Wol.Util.TypeCheck={StringType:1,NumberType:2,BooleanType:4,isString:function(n){return n==undefined||n==null?!1:typeof n=="string"?!0:n instanceof String?!0:!1},isNumber:function(n){return n==undefined||n==null?!1:typeof n=="number"?!0:n instanceof Number?!0:!1},isBoolean:function(n){return n==undefined||n==null?!1:typeof n=="boolean"?!0:n instanceof Boolean?!0:!1},isOfType:function(n,t){if(Sys.Debug.assert(arguments.length==2),!Wol.Util.TypeCheck.isNumber(t))throw Error.argument("type","type must be integer!");var i=!1;return t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.StringType&&(i=Wol.Util.TypeCheck.isString(n),i==!0)?!0:t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.NumberType&&(i=Wol.Util.TypeCheck.isNumber(n),i==!0)?!0:t|Wol.Util.TypeCheck.StringType==Wol.Util.TypeCheck.BooleanType&&(i=Wol.Util.TypeCheck.isBoolean(n),i==!0)?!0:i}},Wol.Util.Event=function(n){Sys.Debug.assert(arguments.length<=1),n?(Sys.Debug.assert(Wol.Util.TypeCheck.isString(n)),this._name=n):this._name="GenericEvent"},Wol.Util.Event.prototype={get_events:function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},addHandler:function(n){Sys.Debug.assert(arguments.length==1),Sys.Debug.assert(n!=undefined&&n!=null),this.get_events().addHandler(this._name,n)},removeHandler:function(n){Sys.Debug.assert(arguments.length==1),Sys.Debug.assert(n!=undefined&&n!=null),this.get_events().removeHandler(this._name,n)},raiseEvent:function(n){Sys.Debug.assert(arguments.length<=1);var t=this.get_events().getHandler(this._name);t&&((n==undefined||n==null)&&(n=Sys.EventArgs.Empty),t(this,n))}},Wol.Util.Event.registerClass("Wol.Util.Event"),Wol.Util.RefCountEvent=function(){Wol.Util.RefCountEvent.initializeBase(this),this._handlerList=[]},Wol.Util.RefCountEvent.prototype={get_HandlersCount:function(){return this._handlerList.length},onHandlersChange:new Wol.Util.Event("on"+this._name+"_HandlersChange"),addHandler:function(n){var t=!1,i;return this._handlerList&&!Array.contains(this._handlerList,n)&&(Array.add(this._handlerList,n),t=!0),i=Wol.Util.RefCountEvent.callBaseMethod(this,"addHandler",[n]),t&&this.onHandlersChange.raiseEvent(),i},removeHandler:function(n){var t=!1,i;return this._handlerList&&(Array.remove(this._handlerList,n),t=!0),i=Wol.Util.RefCountEvent.callBaseMethod(this,"removeHandler",[n]),t&&this.onHandlersChange.raiseEvent(),i}},Wol.Util.RefCountEvent.registerClass("Wol.Util.RefCountEvent",Wol.Util.Event),Wol.Util.Tools={cloneProperties:function(n,t,i){Sys.Debug.assert(arguments.length==3),Sys.Debug.assert(n!=undefined&&n!=null),Sys.Debug.assert(t!=undefined&&t!=null),Sys.Debug.assert(i!=undefined&&i!=null&&i.length>=0);for(var r=0;r<i.length;r++)t[i[r]]=n[i[r]].clone()},parseUrlParams:function(n){var r,e,t,o;if(n===null||n==="")return{};if(typeof n!="string")throw"parseUrlParams: the input parameter must be a string";var i={},u=n.trim().split("&"),f=/[?#&]*([^=]+)(\=([^#]*))?/;for(r=0,e=u.length;r<e;r++)t=f.exec(u[r]),t[2]?(o=t[3].replace(/\+/g,"%20"),i[decodeURIComponent(t[1])]=jQuery.trim(decodeURIComponent(o))):i[decodeURIComponent(t[1])]=null;return i},toUrlParams:function(n){var f=[],i=[],r,t,u,e;for(t in n)n.hasOwnProperty(t)&&(r=typeof n[t],r==="string"||r==="number"||r==="boolean"||n[t]===null)&&i.push(t);for(i.sort(),u=0,e=i.length;u<e;u++)value=n[i[u]],t=encodeURIComponent(i[u]),value===null?f.push(t):(value=encodeURIComponent(value).replace(/\%20/g,"+"),f.push(t+"="+value));return f.join("&")}},Wol.Util.HashParameters=function(){var t=!("onhashchange"in window),n;return t&&(n=function(){var i=!0,f=300,t=null,r=window.location.hash,n=new Wol.Util.RefCountEvent("hashChangeEvent"),u=function(){i&&n.get_HandlersCount()!==0?t||(t=setInterval(e,f)):(clearInterval(t),t=null)},o,e;return n.onHandlersChange.addHandler(u),o=function(t){i&&(i=!1,u()),n.raiseEvent(t)},e=function(){var t=window.location.hash;return r!==t?(r=t,n.raiseEvent(),!0):!1},{onHashChange:n}}()),{attachToHashChangeEvent:function(i){t&&n?n.onHashChange.addHandler(i):jQuery(window).bind("hashchange",i)},detachFromHashChangeEvent:function(i){t&&n?n.onHashChange.removeHandler(i):jQuery(window).unbind("hashchange",i)},getHash:function(n){var t=Wol.Util.Tools.parseUrlParams(window.location.hash);return n!==undefined?t[n.toString()]:t},setHash:function(i){var f=window.location.hash,r="",u=typeof i;if(i===undefined||u!=="object"&&u!=="string")throw"Wol.Util.HashParameters: setHash() requires an object or a string to set the hash.";else r=u==="string"?i:"#"+Wol.Util.Tools.toUrlParams(i);f!==r&&(_hashLastValue=r,window.location.hash=r,t&&n&&n.onHashChange.raiseEvent())}}}(),Wol.Util.CustomEvent=function(){var n={_oSourceElement:null};return{Handlers:{},Attach:function(n,t){t!=null&&n!=null&&(this.Handlers[n]=t)},Detach:function(n){n!=null&&this.Handlers[n]&&delete this.Handlers[n]},Raise:function(t){n._oSourceElement=typeof t!="undefined"?t:null;for(var i in this.Handlers)this.Handlers[i](n._oSourceElement)}}},typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.Cookies=="undefined"&&(Ms.Wol.Cookies={}),Ms.Wol.Cookies=function(){var n={_bCookiesEnabled:null,_sCookieNs:"Ms.Wol.",_GetCookieEnabledState:function(){return n._bCookiesEnabled===null&&(document.cookie="cookiesEnabled=true;",n._bCookiesEnabled=document.cookie.indexOf("cookiesEnabled=true")>-1?!0:!1),n._bCookiesEnabled},_UniquePageIdAvailable:function(){return typeof PageData!="undefined"&&typeof PageData.TopLevelAssetSystemId!="undefined"?!0:!1},_GetUniquePageId:function(){return typeof PageData!="undefined"&&typeof PageData.TopLevelAssetSystemId!="undefined"?PageData.TopLevelAssetSystemId:null},_BuildCookie:function(t,i){var r=i?"":n._GetUniquePageId()+".";return n._sCookieNs+r+t},_GetCurrentDatePlusDays:function(n){var t=new Date;return t.setDate(t.getDate()+n),t.toUTCString()}};return{SetCookie:function(t,i,r,u){if(u||n._UniquePageIdAvailable()&&n._GetCookieEnabledState()&&t&&i){var f=typeof r=="number"?"; expires="+n._GetCurrentDatePlusDays(r):"",e="; path=/";document.cookie=n._BuildCookie(t,u)+"="+escape(i)+f+e}},SetCookieField:function(t,i,r,u,f){var o,s,e,h,c,l;if((f||n._UniquePageIdAvailable()&&n._GetCookieEnabledState())&&i&&r){if(o=this.GetCookie(t,!0),newCookieVal=i+"="+r,o)for(s=o.split("&"),e=0;e<s.length;e++)if(h=s[e],c=h.split("="),c.length===2){if(l=c[0],l==i)continue;newCookieVal+="&"+h}this.SetCookie(t,newCookieVal,u,f)}},GetCookie:function(t,i){var r,u;if(i||n._UniquePageIdAvailable()&&n._GetCookieEnabledState()&&t){var e=n._BuildCookie(t,i),f=document.cookie.split("; "),o=/^([^=]*)=(.*)/i;for(r=0;r<f.length;r++)if(u=o.exec(f[r]),u&&e===u[1])return unescape(u[2])}return null},DeleteCookie:function(n){this.SetCookie(n,"",-1,!0)},CookiesEnabled:function(){return n._GetCookieEnabledState()},CookieStringNotNullEmpty:function(n){return n?!0:!1}}}(),typeof Bing=="undefined"&&(Bing={}),typeof Wol=="undefined"&&(Wol={}),typeof Wol.ContentInstrumentation=="undefined"&&(Wol.ContentInstrumentation={}),Bing.Logging={bingTags:{},customEvents:{},nonBingScn:"nonBingDS",sanitizeGuidRegex:null,entityType:null,loggingCallback:null,appId:null,pageNamePrefix:null,clientId:null,coreInfo:null,clientInfo:null,deviceInfo:null,anid:null,userAgent:null,loggingHeaders:null,timeZone:null,initLogging:null,eventQueue:[],resWidth:null,resHeight:null,dpi:null,bingResObject:null,resOrnt:null,langOrnt:null,Init:function(n,t,i,r){var u=Bing.Logging,e,f,s,o;u._initRegex(),u.clientId=n,u.coreInfo=t,u.clientInfo=i,u.deviceInfo=r,u._setTimeZone(),document.body.clientWidth!=="undefined"&&(u.resWidth=document.body.clientWidth,u.resHeight=document.body.clientHeight);var h="",c="",l="",v="",a="";i!==null&&typeof i!="undefined"&&(i.Client!==null&&(e=i.Client,e.Ver!=="undefined"&&e.Name!=="undefined"&&(h=e.Name+"/"+e.Ver,u.pageNamePrefix="Page."+e.Name),e.Id!=="undefined"&&(u.appId=e.Id)),i.OS!=="undefined"&&(f=i.OS,f.MajorVer!=="undefined"&&f.MinorVer!=="undefined"&&f.BuildVer!=="undefined"&&f.QfeNum!=="undefined"&&(c=f.MajorVer+"."+f.MinorVer+"."+f.BuildVer+"."+f.QfeNum))),r!==null&&typeof r!="undefined"&&(r.Device!=="undefined"&&r.Device.Architecture!=="undefined"&&(l=r.Device.Architecture),r.Oem!=="undefined"&&(s=r.Oem,s.Name!=="undefined"&&s.Model!=="undefined"&&(a=s.Name+";"+s.Model)),r.Screen!=="undefined"&&(o=r.Screen,o.Dpi!=="undefined"&&o.ResOrnt!=="undefined"&&o.LangOrnt!=="undefined"&&(u.resOrnt=o.ResOrnt,u.langOrnt=o.LangOrnt,u.dpi=o.Dpi))),u.bingResObject={w:u.resWidth,h:u.resHeight,dpi:u.dpi},u.userAgent=h+"("+c+";"+l+";"+v+";"+a+")",u._refreshLoggingHeaders(),u.initLogging=!0,u._flushQueuedEvents()},SetLoggingCallback:function(n){var t=Bing.Logging;typeof n=="function"&&n!==null&&(t.loggingCallback=n)},SetEntityType:function(n){var t=Bing.Logging;name!==null&&name!=="undefined"&&(t.entityType=n)},SetUserId:function(n){var t=Bing.Logging;n!==null&&n!=="undefined"&&(t.anid=n),t._refreshLoggingHeaders()},LogClickEvent:function(n){var t=Bing.Logging,i;t._supportedTileClickEvent(n)?t._logEvent("Event.Click",n):t._supportedClientClickEvent(n)&&(i=t._getBingExtensionDataObject("Click",n),t._logEvent("Event.ClientClick",n,i))},LogCustomEvent:function(n,t){var i=Bing.Logging,r=i.customEvents[n],u,f;r&&(u=r.BingEventName,u&&i._supportedCustomEvent(t)&&(f=i._getBingExtensionDataObject(n,t),i._logEvent(u,t,f)))},LogLayoutEvent:function(n,t){var i=Bing.Logging;i._logEvent("Event.GridImpression",n,t)},_logEvent:function(n,t,i){var r=Bing.Logging,f=r._getBingLoggingTimestamp(),u=r._eventLogFactories[n],e;u&&typeof u=="function"&&(e={loggingFactory:u,eventTime:f,biDataObject:t,extendedDataObjects:i},r.eventQueue.push(e),r._flushQueuedEvents())},_flushQueuedEvents:function(){var n=Bing.Logging,i;if(n.initLogging===!0){for(i=0;i<n.eventQueue.length;i++)try{var t=n.eventQueue[i],f=t.loggingFactory,u=t.eventTime,e=t.biDataObject,o=t.extendedDataObjects,s=f(u,e,o);n._sendLoggingRequest(s,u)}catch(r){r&&r.toString&&typeof console!="undefined"&&typeof console.log!="undefined"&&console.log("Error on Bing.Logging._flushQueuedEvents: "+r.toString())}n.eventQueue=[]}},_eventLogFactories:{"Event.GridImpression":function(n,t,i){var r=Bing.Logging,u=r._getBingDataObject(t),e=r._generateRequestUrlObject(u),s=r._generateDisplayBoundingBoxObject(u),o=r._generateFlightInfoObject(u),h=r._generateDataSourceObject(i),c=r._generateLayoutObject(i),f={pn:u.PageId,resOrnt:r.resOrnt,langOrnt:r.langOrnt,res:r.bingResObject,dspGrd:s,DS:h,L:c},l;return e!==null&&e!=="undefined"&&(f.urlData=e),u.pNum!==null&&u.pNum!=="undefined"&&(f.pNum=u.pNum),o&&(f.fltInfo=o),l={T:"Event.GridImpression",TS:n,IG:u.PageIg,D:f}},"Event.Click":function(n,t){var r=Bing.Logging,i=r._getBingDataObject(t),u=r._generateDisplayBoundingBoxObject(i);return{T:"Event.Click",TS:n,IG:i.PageIg,D:{pn:i.PageId,AppNS:i.AppNS,K:i.K,origIG:i.IG,dspSz:u}}},"Event.ClientClick":function(n,t,i){var u=Bing.Logging,r=u._getBingDataObject(t);return{T:"Event.ClientClick",TS:n,IG:r.PageIg,D:{pn:r.PageId,Src:r.Src,Ext:i,origIG:r.IG}}},"Event.Swipe":function(n,t){var r=Bing.Logging,i=r._getBingDataObject(t),u=r._generateDisplayBoundingBoxObject(i);return{T:"Event.Swipe",TS:n,IG:i.PageIg,D:{pn:i.PageId,dspSz:u,dir:i.Dir,ti:i.Time}}}},_supportedTileClickEvent:function(n){for(var t in n)if(t.toLowerCase()==="entity.id")return!0;return!1},_supportedClientClickEvent:function(n){for(var t in n)if(t.toLowerCase()==="src")return!0;return!1},_supportedCustomEvent:function(n){for(var t in n)if(t.toLowerCase()==="search.sug.type")return n[t].toLowerCase()==="n"?!1:!0;return!0},_getBingDataObject:function(n){var t=Bing.Logging,i={};return n!==null&&n!=="undefined"&&t._translateDictionary(t.bingTags,n,i),i},_getBingExtensionDataObject:function(n,t){var r=Bing.Logging,i=null,u,f;return n&&t!==null&&t!=="undefined"&&(u=r.customEvents[n],u&&u.ExtData&&(f=u.ExtData,f==="*"?i=r._getBingDataObject(t):typeof f=="object"&&(i={},r._translateDictionary(f,t,i)))),i},_translateDictionary:function(n,t,i){var f=Bing.Logging,e,o,r,s,u,h,c;if(n&&typeof n=="object")for(e in n){o=!1,r=n[e];for(s in t)if(e.toLowerCase()===s.toLowerCase()){u=t[s],r==="PageId"?(h=f.pageNamePrefix+"."+u,i[r]=h):r==="PageIg"||r==="IG"||r==="Entity.Id"?(c=f._sanitizeGuid(u),i[r]=c):i[r]=u,o=!0;break}o||(i[r]="")}},_generateFlightInfoObject:function(n){var t=null,u,i,r,f;if(n.FltInfo)for(t=[],u=n.FltInfo.split(","),i=0;i<u.length;i++)r=u[i].split(":"),r.length===2&&(f={fltId:r[0],numLn:r[1]},t.push(f));return t},_generateDataSourceObject:function(n){var i=Bing.Logging,r=[],f;for(f in n){var t=i._getBingDataObject(n[f]),e=t.scn===""||t.scn==="undefined"?i.nonBingScn:t.scn,u={scn:e,AppNS:t.AppNS,K:t.K,origIG:t.IG};t["Entity.Id"]&&(u.Entity={Val:t["Entity.Id"],Type:i.entityType}),r.push(u)}return r},_generateLayoutObject:function(n){var r=Bing.Logging,i=[],u,t,f;for(u in n)t=r._getBingDataObject(n[u]),(t.R||t.S||t.Ornt)&&(f={R:t.R,AppNS:t.AppNS,K:t.K,S:t.S,Ornt:t.Ornt},i.push(f));return i},_generateDisplayBoundingBoxObject:function(n){return{FirstVisibleItem:{K:n.FirstVisibleItemKValue,R:n.FirstVisibleItemRValue,AppNS:n.FirstVisibleItemAppNSValue},LastVisibleItem:{K:n.LastVisibleItemKValue,R:n.LastVisibleItemRValue,AppNS:n.LastVisibleItemAppNSValue}}},_generateRequestUrlObject:function(n){var i=Bing.Logging,t=null;return(n.RequestQueryTerm!==""||n.RequestQueryForm!=="")&&(t={FORM:n.RequestQueryForm,FORMIG:n.RequestQueryFormIg,Query:n.RequestQueryTerm,extraParams:{Sort:n.RequestQuerySort,Filter:n.RequestQueryFilter}}),t},_getBingLoggingTimestamp:function(){return Math.round((new Date).getTime())},_sendLoggingRequest:function(n,t){var i=Bing.Logging,u=i.loggingHeaders,f={STS:t,TZ:i.timeZone,AppID:i.appId,E:[n]},e={headers:u,body:f};try{i.loggingCallback(e)}catch(r){r&&r.toString&&typeof console!="undefined"&&typeof console.log!="undefined"&&console.log("Error on Bing.Logging._sendLoggingRequest: "+r.toString())}},_refreshLoggingHeaders:function(){var n=Bing.Logging,t=[{name:"X-Search-ClientID",value:n.clientId},{name:"X-Inst-ANID",value:n.anid},{name:"User-Agent",value:n.userAgent}],i=[],r;for(r in t)n._isNullOrWhitespace(t[r].value)||i.push(t[r]);n.loggingHeaders=i},_isNullOrWhitespace:function(n){return typeof n=="undefined"||n===null?!0:typeof n=="string"&&n.trim()===""?!0:!1},_setTimeZone:function(){var t=Bing.Logging,i=new Date,n=i.getTimezoneOffset(),r=Math.floor(Math.abs(n/60)),u=Math.abs(n%60),f=n>0?"-":"";t.timeZone=f.toString()+r.toString()+":"+u.toString()+":00"},_initRegex:function(){var n=Bing.Logging;n.sanitizeGuidRegex=new RegExp(/[^a-fA-F0-9]/g)},_sanitizeGuid:function(n){var t=Bing.Logging;if(n!==null)return n.replace(t.sanitizeGuidRegex,"")}},Wol.ContentInstrumentation.Logging={SharedTags:{},Max_UInt32:4294967295,Max_Int64:0x7FFFFFFFFFFFFFFF,Min_Int64:-0x7FFFFFFFFFFFFFFF,Str_NullArg:"Parameter must not be null or empty",clientBiSettingsUri:"ClientBISettings.js",customEventField:"CustomEvent",userInfo:null,clientInfo:null,deviceInfo:null,coreTags:[],coreTagsRegex:null,envDomain:null,env:null,explicitBiInitParam:"&cot=201",explicitClickEventParam:"&cot=206",explicitSamplingInitParam:"&cot=202",httpScheme:"http:",impressionFilter:"*",bingImpressionFilter:"*",initLogging:null,bingLoggingEnabled:!1,isBiSelectorSupported:typeof document.querySelectorAll!="undefined",maxPartitionKey:"0",sampling_None:{"":{InSample:1,IsDefault:!0,FlexField:""}},sampling_Default:null,sessionDomain:".microsoft.com",scriptPath:null,scriptIsReady:!1,tagPrefix:"ms.",tagRegex:null,viewDataIsReady:!1,batchBeacons:[],customEventBeacons:[],clickEvents:[],samplingEvents:[],onInitComplete:null,loggingCallback:null,Annotate:function(n,t,i){var r=Wol.ContentInstrumentation.Logging,u,f;try{if(n==null||n=="")throw Error.argument("dataname",r.Str_NullArg);if(u=r._getDomTarget([i,this]),u==null)throw Error.argument("element","Parameter can only be null if 'this' is a DOM element");f=r._getAnnotationName(n),r._setAttr(u,f,t)}catch(e){r._logError(e)}},AnnotateMetatag:function(n,t){var i=Wol.ContentInstrumentation.Logging,r;try{if(n==null||n=="")throw Error.argument("dataname",i.Str_NullArg);r=i._getAnnotationName(n),i._setAnnotatedMetatag(r,t)}catch(u){i._logError(u)}},AnnotateMany:function(n,t){var i=Wol.ContentInstrumentation.Logging,r;try{if(n==null)throw Error.argument("dictionary",i.Str_NullArg);for(r in n)i.Annotate(r,n[r],t)}catch(u){i._logError(u)}},AnnotateManyMetaTag:function(n){var t=Wol.ContentInstrumentation.Logging,i;try{if(n==null)throw Error.argument("dictionary",t.Str_NullArg);for(i in n)t.AnnotateMetatag(i,n[i])}catch(r){t._logError(r)}},GetSessionID:function(){var t=Wol.ContentInstrumentation.Logging,n="",i;try{i=Wol.Mscom.sessionGuidCookieName,n=t._getCookieValue(i),n=n.indexOf("=")===-1?n:null}catch(r){t._logError("GetSessionID Error:"+r)}return n},GetUserHash:function(){return Wol.Mscom.userHashField},GetMuid:function(){var i=Wol.ContentInstrumentation.Logging,r="",u="",e,f,n,t;try{for(e=Wol.Mscom.visitorCookieName,r=i._getCookieValue(e),f=r.split("&"),n=0;n<f.length;n++)if(t=f[n].split("="),t.length===2&&t[0]==="GUID"){u=unescape(t[1]);break}}catch(o){i._logError("GetMuid Error:"+o)}return u},GuidTo32bit:function(n){var i=Wol.ContentInstrumentation.Logging,t=null;return n&&typeof n=="string"&&n.length===32&&(t=i.HexTo32bit(n)),t},HexTo32bit:function(n){var t=Wol.ContentInstrumentation.Logging;return t.HexToInt(n.substring(0,8))},HexToInt:function(n){var t=isNaN("0x"+n)?null:parseInt(n,16);return t&&isFinite(t)?t:null},SetSessionID:function(n){var t=Wol.ContentInstrumentation.Logging,i=Wol.Mscom,r=i.sessionGuidCookieName,u;i.previousSessionID=t.GetSessionID(),u=r+"="+escape(n)+";domain="+t.sessionDomain+";path=/",document.cookie=u,t.InitSessionID()},SetUserInfo:function(n,t){var i=Wol.ContentInstrumentation.Logging,u=Bing.Logging,r=Wol.Mscom;r.userHashField!==n&&(r.userHashField=typeof n=="string"&&n.length>0&&n.length<=16?n:"",i.InitSampling()),t!==null&&typeof t!="undefined"&&(i.userInfo=t,t.ANID!=="undefined"&&u.SetUserId(t.ANID))},SetEntityType:function(n){var t=Bing.Logging;n!=="undefined"&&t.SetEntityType(n)},LogCustomEventsBatch:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,s=Wol.Mscom,y,d,o,c,f,e,g,nt,h,rt,l;if(u.initLogging===!0&&u._checkSampling(r))try{if(n===null||n==="")throw Error.argument("eventName",u.Str_NullArg);if(t===null||typeof t!="object"||t.length===undefined)throw Error.argument("eventBatch","Parameter must not be a non-null array of json objects");var p=1800,w=s.GetBaseSrcString()+s.customEventParam,a="&"+u._getAnnotationName(n)+"=",v="%1E",tt="%1D",b=u._getBiDataMap(null,i,null),k=u._getAnnotatedMetatags();for(y=0;y<k.length;y++)d=k[y],b.Push(d.shortname,d.value);for(o=s.EncodeCustomEventStr(b.GetMscomArray()),c="";t.length>0;)if(f=t.pop(),typeof f=="object"){e={biDataObject:null,element:null},e.element=u._getDomTarget([f.element,f]),e.biDataObject=typeof f.biDataObject=="object"?f.biDataObject:f!==e.element?f:null,g=u._getBiDataMap(null,e.biDataObject,e.element),nt="";for(h in g.Values)rt=h.indexOf(u.tagPrefix)===0?h.substr(u.tagPrefix.length):h,nt+=h+"="+g.Values[h]+tt;l=s.Encode(nt),p<l.length?u.LogCustomBI(n,e.biDataObject,e.element):p>=a.length+o.length+l.length+v.length?o+=v+l:(c=w+a+o,u.batchBeacons.push(c),o=s.Encode(pageMetadataStr)+v+l)}o!==""&&(c=w+a+o,u.batchBeacons.push(c)),u._flushQueuedEvents()}catch(it){u._logError(it)}},LogCustomBI:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,f=Wol.Mscom,s,o,c;if(u.initLogging===!0)try{if(s=u._checkSampling(r),s||u.bingLoggingEnabled){if(n==null||n=="")throw Error.argument("eventName",u.Str_NullArg);var l=u._getDomTarget([i,this]),e=u._getBiDataMap(n,t,l),h=u._getAnnotatedMetatags();for(o=0;o<h.length;o++)c=h[o],e.Push(c.shortname,c.value);if(e.Push(u.customEventField,n),s){var a=f.GetBaseSrcString(),v=a+f.customEventParam+f.EncodeCustomEventStr(e.GetMscomArray()),y=f.EnsureBeaconSrcLength(v);u.customEventBeacons.push(y),u._flushQueuedEvents()}u.bingLoggingEnabled&&Bing.Logging.LogCustomEvent(n,e.GetBingArray())}}catch(p){u._logError(p)}},LogImpressions:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,k=Bing.Logging,l,a,e,v,y,s,p,w,b,o,f,g;if(u.initLogging===!0)try{var d=u._checkSampling(r),h=d&&u.impressionFilter!=="",c=u.bingLoggingEnabled&&u.bingImpressionFilter!=="";if(h||c){if(l=u._getDomTarget([n,this]),l==null)throw Error.argument("element","Parameter 'element' can only be null if 'this' is a DOM element");if(a=u._getAnnotatedComponents(l),h&&(e=[],v=u._queryFilter(a,u.impressionFilter),v.length>0&&(e=u._map(v,function(){return{biDataObject:t,element:this}})),Object.prototype.toString.call(i)==="[object Array]"&&i.length>0&&(y=u._map(i,function(n){var i=t,r;for(r in n)i[r]=n[r];return{biDataObject:i}}),e=e.length===0?y:e.concat(y)),e.length>0&&u.LogCustomEventsBatch("Impression",e)),c&&(s=u._queryFilter(a,u.bingImpressionFilter),Object.prototype.toString.call(i)==="[object Array]"&&i.length>0||s.length>0)){for(p=u._getBiDataMap(null,t,n),w=u._getAnnotatedMetatags(),f=0;f<w.length;f++)b=w[f],p.Push(b.shortname,b.value);for(o=[],f=0;f<s.length;f++)g=u._getBiDataMap(null,null,s[f]),o[f]=g.GetBingArray();Object.prototype.toString.call(i)==="[object Array]"&&(o=o.length===0?i:o.concat(i)),k.LogLayoutEvent(p.GetBingArray(),o)}}}catch(nt){u._logError(nt)}},SetEnvironment:function(n){var t=Wol.ContentInstrumentation.Logging;n!=""&&(t.envDomain=n)},SetTagConfig:function(n,t,i,r,u){var f=Wol.ContentInstrumentation.Logging;try{f.tagPrefix=n+".",f.impressionFilter=r,f.bingImpressionFilter=u,f.coreTags=f._map(i,function(n){return f.tagPrefix+n}),f._initRegex()}catch(e){f._logError("SetTagConfig Error: "+e)}},SetClientConfig:function(n){var t=Wol.ContentInstrumentation.Logging;(n==null||n=="")&&(n="ClientBISettings.js"),n.indexOf(":")<0&&t.scriptPath!=null&&(n=t.scriptPath+n),t.clientBiSettingsUri=n},SetLoggingCallback:function(n){var t=Wol.ContentInstrumentation.Logging,i=Bing.Logging;typeof n=="function"&&n!==null&&(t.loggingCallback=n,i.SetLoggingCallback(n))},Init:function(n,t,i,r,u){var f=Wol.ContentInstrumentation.Logging,s=Bing.Logging,e,o;if(f.bingLoggingEnabled=t,i!==null&&i!=="undefined"&&(f.coreInfo=i),r!==null&&r!=="undefined"&&(f.clientInfo=r,f._refreshClientInfo()),u!==null&&u!=="undefined"&&(f.deviceInfo=u),typeof n=="undefined"&&(n=!0),f.initLogging!=!1&&(f.initLogging=f._getLogEnabledHHSetting()&&f._getLogEnabledMetatagValue()),f.initLogging){if(f.envDomain==null||f.envDomain=="")throw Error.argument("env","WEDCS Environment has not properly initialized");f.viewDataIsReady=!0,e=!1,o=function(){t!==null&&typeof t!="undefined"&&t&&s.Init(f.GetMuid(),i,r,u),e&&f.scriptIsReady&&typeof Wol.ContentInstrumentation.BiSettings!="undefined"&&(n?f.FirePageViewEvent():f._flushQueuedEvents())},typeof Ms!="undefined"&&typeof Ms.Wol!="undefined"&&typeof Ms.Wol.BIPreloadDatabag!="undefined"&&f.AnnotateManyMetaTag(Ms.Wol.BIPreloadDatabag),f.InitClientSettings(o),f._onDomReady(function(){e=!0,o()})}},InitClientSettings:function(n){var t=Wol.ContentInstrumentation.Logging,r,i,u,f;try{r=new Date,r.setMinutes(0,0,0),i=t.clientBiSettingsUri.indexOf("?")>=0?"&":"?",u=t.clientBiSettingsUri+i+"t="+r.getTime().toString(),f=function(){var i,u,r,f;typeof Wol.ContentInstrumentation.BiSettings!="undefined"&&(i=Wol.ContentInstrumentation.BiSettings,i.get=function(n,t){return typeof i[n]=="undefined"?t:i[n]},t.initLogging=i.get("BILog",t.initLogging),t.impressionFilter=i.get("ImpressionFilter",t.impressionFilter),t.maxPartitionKey=i.get("MaxPartitionKey",t.maxPartitionKey),t.sessionDomain=i.get("SessionDomain",t.sessionDomain),t.httpScheme=i.get("BIScheme",t.httpScheme),t.httpScheme==="auto"&&(t.httpScheme=window.location.protocol),t.env=t.httpScheme+"//"+t.envDomain,t.SharedTags=i.get("SharedTags",t.SharedTags),u=Bing.Logging,t.bingImpressionFilter=i.get("BingImpressionFilter",t.bingImpressionFilter),u.bingTags=i.get("BingTags",u.bingTags),u.customEvents=i.get("BingCustomEvents",u.customEvents),r=Wol.Mscom,r.tagPrefix=t.tagPrefix.toLowerCase(),r.wedcsUriBase=t.env,r.browserDelay=i.get("BrowserDelay",r.browserDelay),r.varClickTracking=i.ClickTracking!=null&&typeof i.ClickTracking!="undefined"?i.ClickTracking:!0,i.FlexInfo||(i.FlexInfo={}),r.InitFlexInfo(i.FlexInfo),f=function(){var u,i,r;for(t.InitSessionID(),t.scriptIsReady=!0,u=[t.onInitComplete,n],i=0;i<u.length;i++)if(r=u[i],typeof r=="function"&&r!==null)try{r()}catch(f){t._logError("SessionInit Completed callback error: "+f)}},t.InitCookieData(f))},t._loadScript(u,f)}catch(e){t._logError("InitClientSettings Error: "+e)}},_loadScript:function(n,t){var r=!1,u=document.getElementsByTagName("head")[0]||document.body,i=document.createElement("script"),e,f;i.src=n,e=function(){var n=i.parentNode;i.onload=null,i.onreadystatechange=null,n&&n.removeChild&&n.removeChild(i)},f=function(){r=!0,t(),e()},i.onload=function(){r||f()},i.onreadystatechange=function(){r||(i.readyState==="loaded"||i.readyState==="complete")&&f()},u.insertBefore(i,u.firstChild)},InitCookieData:function(n){var t=Wol.ContentInstrumentation.Logging,r=Wol.ContentInstrumentation.BiSettings,i=Wol.Mscom,u=t.GetSessionID(),f=t.GetMuid(),e=function(){try{typeof n=="function"&&n!==null&&n()}catch(i){t._logError("InitCookieData Completed callback error: "+i)}},o;u&&u.length>0&&f&&f.length>0?e():(i.InitRoute(r.ControlCode,r.RoutingCode,"I"),o=i.GetBaseSrcString()+t.explicitBiInitParam,i.SendBeacon(o,e))},InitSessionID:function(){var t=Wol.ContentInstrumentation.Logging,r,i;try{r=Wol.Mscom,i=Wol.ContentInstrumentation.BiSettings,r.InitRoute(i.ControlCode,i.RoutingCode,t._getPartitionKey()),t.InitSampling()}catch(u){t._logError("InitSessionID Error: "+u)}},InitSampling:function(){var n=Wol.ContentInstrumentation.Logging,t=Wol.ContentInstrumentation.BiSettings,r=Wol.Mscom,u,e,f,i,o,s,h;if(n.initLogging===!0&&t)try{if(u=!0,e="",t.Sampling){o=0;for(i in t.Sampling)t.Sampling.hasOwnProperty(i)&&(o++,f=t.Sampling[i],u=n._initSamplingRule(i,f)&&u,e+=f.FlexField+";");s=t.SamplingDefault||(o===1?i:""),n.sampling_Default=t.Sampling[s]||n.sampling_None}else t.Sampling=n.sampling_None,n.sampling_Default=n.sampling_None[""];u||(r.samplingInfo=e,h=r.GetBaseSrcString()+n.explicitSamplingInitParam,n.samplingEvents=[h],r.samplingInfo="")}catch(c){n._logError("InitSampling Error: "+c)}},FirePageViewEvent:function(n,t,i,r){var u=Wol.ContentInstrumentation.Logging,f;if(u.initLogging===!0)try{f=function(){if(u.viewDataIsReady===!0&&u.scriptIsReady===!0&&u._checkSampling(i)){n==null?Wol.Mscom.Init():u._logJsonPageViewEvent(n),t||(t=document.body);var f=t.getAttribute("BI.SuppressImpression");(f===null||typeof f=="undefined"||f!==1)&&u.LogImpressions(t,n,r,i),u._flushQueuedEvents()}},f()}catch(e){u._logError("FirePageView Error: "+e)}},FireClickEvent:function(n,t,i,r,u,f){var s=Wol.ContentInstrumentation.Logging,b=Bing.Logging,o=Wol.Mscom,y,a,p,v,w,e,g;if(s.initLogging===!0)try{if(y=s._checkSampling(f),y||s.bingLoggingEnabled){for(a=s._getBiDataMap(null,n,t),p=s._getAnnotatedMetatags(),v=0;v<p.length;v++)w=p[v],a.Push(w.shortname,w.value);if(s.bingLoggingEnabled&&b.LogClickEvent(a.GetBingArray()),y){var k=o.GetBaseSrcString(),d=o.EncodeCustomEventStr(a.GetMscomArray()),l="",c="",h="";if(t&&(e=s._getDomTarget([t,this]),e&&e.tagName)){l=o.GetId(e);switch(e.tagName){case"A":c=e.innerText||"",h=e.href||"";break;case"IMG":c=e.alt||"",h=o.GetImageHREF(e);break;case"AREA":c=e.alt||"",h=e.href||"";break;case"INPUT":type=e.type,(type=="button"||type=="reset"||type=="submit"||type=="image"||type=="text"||type=="search")&&(g=e.value||e.name||e.alt||e.id,c=g||"",h=e.form?e.form.action||window.location.pathname:window.location.pathname)}}l=u||l,c=r||c,h=i||h;var nt="&cn="+o.GetUrlParameter("cn",o.Encode(c))+"&cid="+o.GetUrlParameter("cid",o.Encode(l))+"&ct="+o.GetUrlParameter("ct",o.Encode(h)),tt=k+s.explicitClickEventParam+nt+d,it=o.EnsureBeaconSrcLength(tt);s.clickEvents.push(it),s._flushQueuedEvents(),o.browserDelay>0&&o.Pause(o.browserDelay)}}}catch(rt){s._logError("FireClickEvent Error: "+rt)}},FireClickTrackingEvent:function(n,t){var i=Wol.ContentInstrumentation.Logging;if(i.initLogging===!0&&i._checkSampling(t))try{if(n==null)throw Error.argument("event",i.Str_NullArg);Wol.Mscom.ProcessClick(n)}catch(r){i._logError(r)}},_isInt:function(n){var t=parseInt(n);return isNaN(t)?!1:t==n&&t.toString()==n.toString()},_checkSampling:function(n){var t=Wol.ContentInstrumentation.Logging,r=Wol.ContentInstrumentation.BiSettings,i;return t.initLogging===!0&&t.scriptIsReady===!0?(t._flushQueuedSamplingEvents(),i=n&&(n.InSample===0||n.InSample===1)?n:t.sampling_Default,Wol.Mscom.samplingInfo=i.FlexField||"",i.InSample):!0},_refreshClientInfo:function(){var t=Wol.ContentInstrumentation.Logging,o=Wol.Mscom,i=t.clientInfo,n,e;if(i!==null&&typeof i!="undefined"){var s="",r="",u="",f="";i.OS!=="undefined"&&(n=i.OS,n.MajorVer!=="undefined"&&t._isInt(n.MajorVer)&&n.MinorVer!=="undefined"&&t._isInt(n.MinorVer)&&n.BuildVer!=="undefined"&&t._isInt(n.BuildVer)&&n.QfeNum!=="undefined"&&t._isInt(n.QfeNum)&&(r="o:"+n.MajorVer+"."+n.MinorVer+"."+n.BuildVer+"-"+n.QfeNum),n.AppModel!=="undefined"&&t._isInt(n.AppModel)&&(u="am:"+n.AppModel)),i.Client!==null&&(e=i.Client,e.Ver!=="undefined"&&t._isInt(e.Ver)&&(f="c:"+e.Ver)),r!=""&&u!=""&&f!=""&&(o.clientInfoField=r+";"+f+";"+u)}},_getBiDataMap:function(n,t,r){var f=Wol.ContentInstrumentation.Logging,c=Bing.Logging,o=Wol.Mscom,u={MscomValues:{},BingValues:{},Push:function(t,r){var h,p,y,v;if(r!==null&&typeof r!="undefined"&&(h=r.toString(),h!=="")){var a=!1,e=!1,s=f._getAnnotationName(t,n),l=f._getFieldName(s);for(p in c.bingTags)if(p.toLowerCase()===l.toLowerCase()){for(v in u.BingValues)if(v.toLowerCase()===s.toLowerCase()){e=!0;break}e||(u.BingValues[l]=h,e=!0);break}y=!1;for(i in o.mscomTags)if(o.mscomTags[i].toLowerCase()===l.toLowerCase()){y=!0;break}if(y||!e){for(v in u.MscomValues)if(v.toLowerCase()===s.toLowerCase()){a=!0;break}a||(u.MscomValues[s]=h)}}},PushList:function(n){var t,i;if(n)for(t=0;t<n.length;t++)i=n[t],u.Push(i.name,i.value)},GetBingArray:function(){return u.BingValues},GetMscomArray:function(){var n=[],t,i;for(t in u.MscomValues)i=u.MscomValues[t],typeof i=="string"&&n.push(t,i);return n}},s,h,e,l,a;if(t!=null)for(s in t)u.Push(s,t[s]);if(r!=null){for(h=[],e=r.parentNode;e;e=e.parentNode)h.push(e);l=f._getAnnotatedData(r),a=f._map(h,f._getAnnotatedData),u.PushList(l),u.PushList(a)}return u},_getPartitionKey:function(){var n=Wol.ContentInstrumentation.Logging,r,t,i;if(n.maxPartitionKey&&n.maxPartitionKey!=""){r=n._getRandPartition(n.maxPartitionKey),t=r;try{i=n.GetSessionID(),i!=null&&i.length>=n.maxPartitionKey.length&&(i=i.toLowerCase(),t=i.substring(0,n.maxPartitionKey.length),t=t<=n.maxPartitionKey.toLowerCase()?t:r)}catch(u){n._logError("Error determining partition key: "+u)}return t}return""},_getRandPartition:function(n){try{var t=parseInt(n,16);return Math.floor(Math.random()*(t+1)).toString(16)}catch(i){return Math.floor(Math.random()*16).toString(16)}},_getDomTarget:function(n){for(var r,t,i=0;i<n.length;i++)if(t=n[i],t!==null&&typeof t!="undefined"&&typeof t.nodeType!="undefined"&&t.nodeType==1){r=t;break}return r},_getElementsUnder:function(n,t){var i=Wol.ContentInstrumentation.Logging;return i._filter(i._queryDom(n,t),function(n){for(var i=n.parentNode;i&&i!==t;i=i.parentNode);return i===t})},_getAnnotationName:function(n,t){var i=Wol.ContentInstrumentation.Logging;return t=t==null||typeof t!=" string"?"":t+".",i._isBiAnnotation(n)?n:i.tagPrefix+t+n},_getAnnotatedData:function(n){var t=Wol.ContentInstrumentation.Logging;return t._map(n.attributes,function(i){var r;return t._isBiAnnotation(i.name)&&i.value!=""&&(r={domElement:n,name:i.name,shortname:i.name.substr(t.tagPrefix.length),value:i.value}),r})},_getCookieValue:function(n){for(var u="",f=document.cookie.split("; "),t,r,i=0;i<f.length;i++)if(t=f[i],r=t.indexOf("="),r!==-1&&t.substring(0,r)===n){u=unescape(t.substring(r+1,t.length));break}return u},_getFieldName:function(n){var i=Wol.ContentInstrumentation.Logging.tagPrefix,t=n;return t&&typeof t=="string"&&t.toLowerCase().indexOf(i.toLowerCase())===0?t.slice(i.length):t},_initRegex:function(){var n=Wol.ContentInstrumentation.Logging;n.tagRegex=new RegExp("^"+n.tagPrefix,"i"),n.coreTagsRegex=new RegExp(n._getCoreTagsRegex(),"i")},_isBiAnnotation:function(n){var t=Wol.ContentInstrumentation.Logging.tagRegex;return t!=null?t.test(n):!1},_getComponentSelectors:function(){var n=Wol.ContentInstrumentation.Logging;return n._getHasAttributeSelectors(n.coreTags)},_getCoreTagsRegex:function(){var t=Wol.ContentInstrumentation.Logging,n=t.coreTags;return typeof n=="string"&&(n=[n]),"^("+t._map(n,function(n){return t._escapeAttributeName(n)}).join("|")+")$"},_getHasAttributeSelectors:function(n){var t=Wol.ContentInstrumentation.Logging;return typeof n=="string"&&(n=[n]),t._map(n,function(n){return"["+t._escapeAttributeName(n)+"]"}).join(", ")},_getAnnotatedComponents:function(n){var t=Wol.ContentInstrumentation.Logging,i=t.isBiSelectorSupported?t._getComponentSelectors():"*",r=t.isBiSelectorSupported?null:t.coreTagsRegex;return t._findChildrenByAttributes(n,i,r)},_findBySingleAttribute:function(n,t){var i=Wol.ContentInstrumentation.Logging,r=i.isBiSelectorSupported?i._getHasAttributeSelectors(t):"*",u=i.isBiSelectorSupported?null:new RegExp("^"+i._escapeAttributeName(t)+"$");return i._findChildrenByAttributes(n,r,u)},_findChildrenByAttributes:function(n,t,i){var s=Wol.ContentInstrumentation.Logging,u=s._getElementsUnder(t,n),o,f,r,e;if(i!=null){for(o=[],f=0;f<u.length;f++)if(r=u[f],r.attributes&&r.attributes.length)for(e=0;e<r.attributes.length;e++)if(i.test(r.attributes[e].name)){o.push(r);break}u=o}return u},_escapeAttributeName:function(n){return n.replace(/\./g,"\\.")},_getAttr:function(n,t){var i=n.getAttribute?n.getAttribute(t):n[t];return i===null?undefined:i},_setAttr:function(n,t,i){i?n.setAttribute?n.setAttribute(t,i):n[t]=i:n.removeAttribute?n.removeAttribute(t):n[t]=undefined},_getLogEnabledHHSetting:function(){try{return!(typeof window.external=="object"&&typeof window.external.NoImplicitFeedback=="boolean"&&window.external.NoImplicitFeedback==!0)}catch(n){return!0}},_getLogEnabledMetatagValue:function(){for(var u=Wol.ContentInstrumentation.Logging,i=!0,f=document.getElementsByTagName("head")[0],r=f.getElementsByTagName("meta"),t,n=0;n<r.length;n++)t=r[n],t&&t.name==="BI.Log"&&!new Boolean(u._getAttr(t,"content"))&&(i=!1);return i},_getAnnotatedMetatags:function(){var n=Wol.ContentInstrumentation.Logging,t=document.getElementsByTagName("head")[0],i=n._filter(t.getElementsByTagName("meta"),function(t){return t&&t.name.toLowerCase().indexOf(n.tagPrefix.toLowerCase())===0});return n._map(i,function(t){var r=t,i=n._getAttr(t,"name"),u=n._getAttr(t,"content");return{domElement:r,name:i,shortname:i.substr(n.tagPrefix.length),value:u}})},_getSessionSampleHash:function(){var n=Wol.ContentInstrumentation.Logging,t=n.GetSessionID();return n.GuidTo32bit(t)},_getRandomSampleHash:function(){return Math.random()*Wol.ContentInstrumentation.Logging.Max_UInt32},_initSamplingRule:function(n,t){var r=Wol.ContentInstrumentation.Logging,f=!0,u=1,i,e;return n&&t&&(typeof t.Type=="undefined"&&(t.Type=0),t.Type===1?!t.Rate||t.Rate<0||t.Rate>100?(t.Rate=100,t.inSample=1):(i=null,u=t.Rate/100,typeof t.getUserHash=="function"&&t.getUserHash!==null&&(i=t.getUserHash()),(!i||isNaN(i)||i<0||i>r.Max_UInt32)&&(i=r._getSessionSampleHash()||r._getRandomSampleHash()),t.InSample=i<u*r.Max_UInt32?1:0):t.InSample=1,e=u===1?"":u.toString().substring(2,6),t.FlexField=n+":"+t.Type.toString()+","+e+","+t.InSample.toString(),f=t.InSample),f},_setAnnotatedMetatag:function(n,t){for(var s=Wol.ContentInstrumentation.Logging,f=!1,e=document.getElementsByTagName("head")[0],o=e.getElementsByTagName("meta"),i,u,r=0;r<o.length;r++)i=o[r],i&&i.name&&i.name.toLowerCase()===n.toLowerCase()&&(f=!0,s._setAttr(i,n,t));f||(u=document.createElement("meta"),u.setAttribute("name",n),u.setAttribute("content",t),e.appendChild(u))},_flushQueuedEvents:function(){var t=Wol.ContentInstrumentation.Logging,n;if(t.scriptIsReady===!0){for(n=0;n<t.batchBeacons.length;n++)Wol.Mscom.SendBeacon(t.batchBeacons[n]);for(t.batchBeacons=[],n=0;n<t.customEventBeacons.length;n++)Wol.Mscom.SendBeacon(t.customEventBeacons[n]);for(t.customEventBeacons=[],n=0;n<t.clickEvents.length;n++)Wol.Mscom.SendBeacon(t.clickEvents[n]);t.clickEvents=[]}},_flushQueuedSamplingEvents:function(){var n=Wol.ContentInstrumentation.Logging,t;if(n.scriptIsReady===!0&&n.samplingEvents&&n.samplingEvents.length>0){for(t=0;t<n.samplingEvents.length;t++)Wol.Mscom.SendBeacon(n.samplingEvents[t]);n.samplingEvents=[]}},_initCurrentScriptPath:function(){var n=Wol.ContentInstrumentation.Logging;if(n.scriptPath==null){try{var r=document.getElementsByTagName("script"),i=r[r.length-1].src,t=i.lastIndexOf("/");t=t<0?i.lastIndexOf("\\"):t,t=t<0?0:t,n.scriptPath=i.substring(0,t)+"/"}catch(u){n.scriptPath="/",n._logError(u)}n.clientBiSettingsUri=n.scriptPath+n.clientBiSettingsUri}},_filter:function(n,t){for(var r=[],u,i=0;i<n.length;i++)u=n[i],t(u)&&r.push(u);return r},_intersect:function(n,t){var e=Wol.ContentInstrumentation.Logging,o=[],u={},i=n,f=t,r;for(n.length>t.length&&(i=t,f=n),r=0;r<i.length;r++)u[i[r]]=1;return e._filter(f,function(n){return n in u})},_map:function(n,t){var f=[],r,i,u;if(n)for(r=0;r<n.length;r++)if(i=t(n[r]),i!==undefined&&i!==null)for(i=i.length===undefined||typeof i!="object"?[i]:i,u=0;u<i.length;u++)f.push(i[u]);return f},_onDomReady:function(n){typeof jQuery!="undefined"?jQuery(document).ready(n):document.addEventListener("DOMContentLoaded",n)},_queryDom:function(n,t){var r=Wol.ContentInstrumentation.Logging,i=[];return n&&(t=t||document,typeof jQuery!="undefined"?i=jQuery(n,t):t.querySelectorAll?i=t.querySelectorAll(n):r._logError("_queryDom Error: Unable to evaluate CSS selector - browser does not support querySelector APIs")),i},_queryFilter:function(n,t){var r=Wol.ContentInstrumentation.Logging,i=[];return t&&(i=t==="*"?n:r._intersect(n,r._queryDom(t))),i},_logJsonPageViewEvent:function(n){var i=Wol.ContentInstrumentation.Logging,t,r,e,s,h;if(i.initLogging==!0){t=Wol.Mscom,t.HandleSession(),t.setEvents();var o=t.GetBaseSrcString(),u=i._getBiDataMap(null,n,null),f=i._getAnnotatedMetatags();for(r=0;r<f.length;r++)e=f[r],u.Push(e.shortname,e.value);s=t.EncodeCustomEventStr(u.GetMscomArray()),h=t.EnsureBeaconSrcLength(o+s),t.SendBeacon(h)}},_logError:function(n){if(n!=null&&typeof console!="undefined"&&typeof console.log!="undefined"){var t=n.toString();console.log(t)}}},Wol.ContentInstrumentation.Logging._initCurrentScriptPath(),Wol.Mscom={fl:0,sessionId:"",sessionDuration:18e5,sessionCookieName:"MC0",sessionGuidCookieName:"MS0",visitorCookieName:"MC1",cookieDisabled:0,pvInfo:[],metaTags:"",customTags:"",clickInfo:"",flexInfo:"",qs:"",currTimeTicks:0,currTimeAsString:"",imgArray:[],imgArrayIndex:0,imgArrayMax:25,customInfo:"",tz:420,slC:"",flC:"",cntC:"",bsC:"",clickedElements:["A","IMG","AREA","INPUT"],pKey:"",routeCode:"",ctrlCode:"",routeParams:"",customEventParam:"&cot=5",tagPrefix:"ms.",clickPrefix:"Click.",debugOn:!1,previousSessionID:"",samplingInfo:"",userHashField:"",clientInfoField:"",disableDefaultLoggingAttribute:"data-disabledefaultlogging",queryParamLength:{ti:[1e3,1e3],sr:[20,0],bs:[20,0],cn:[500,500],cid:[100,100],ct:[500,500]},optInfoHandler:null,wedcsUriBase:"http://__REPLACE_FQDN__",varClickTracking:0,browserDelay:0,CustomEvent:function(){var n=Wol.Mscom;try{n.HandleSession(),n.customInfo+=n.EncodeCustomEventStr(arguments),n.customInfo!=""&&n.Beacon()}catch(t){n.debug("CustomEvent:"+t)}},EncodeCustomEventStr:function(n){for(var i=Wol.Mscom,r="",f=n.length,u,t=0;t<f;t=t+2)u=n[t].toString().toLowerCase(),u.indexOf(i.tagPrefix)==0&&(r+="&"+i.Encode(u)+"="+(n[t+1]==undefined?"":i.Encode(n[t+1].toString())));return r},SetPVInfoCore:function(){var n=Wol.Mscom,t;n.SetTime(),n.pvInfo.push("tz="+n.tz/-60),window.varSegmentation!=undefined&&varSegmentation==1&&n.pvInfo.push("&cs=1"),n.cookieDisabled==1&&n.pvInfo.push("&cd=1"),n.pvInfo.push("&ti="+n.GetUrlParameter("ti",n.Encode(document.title))),t=n.Encode(document.referrer),t!=null&&t!=""&&n.pvInfo.push("&r="+t),n.pvInfo.push("&ts="+n.currTimeAsString),typeof screen=="object"&&n.pvInfo.push("&sr="+n.GetUrlParameter("sr",screen.width+"x"+screen.height)),n.GetBrowserSize(),n.samplingInfo!=""&&n.pvInfo.push("&ff3="+n.samplingInfo),n.userHashField!=""&&n.pvInfo.push("&ff4="+n.userHashField),n.previousSessionID!=""&&(n.pvInfo.push("&ff5="+n.previousSessionID),n.previousSessionID=""),n.clientInfoField!=""&&n.pvInfo.push("&ff6="+n.clientInfoField),n.flexInfo!=""&&n.pvInfo.push(n.flexInfo)},SetPVInfo:function(){var n=Wol.Mscom;n.SetPVInfoCore(),n.optInfoHandler!==null&&typeof n.optInfoHandler=="object"&&n.optInfoHandler()},GetBrowserSize:function(){var n=Wol.Mscom;if(n.bsC!=""){n.pvInfo.push(n.bsC);return}document.body.clientWidth!=undefined?n.bsC=document.body.clientWidth+"x"+document.body.clientHeight:document.documentElement&&document.documentElement.clientWidth!=undefined?n.bsC=document.documentElement.clientWidth+"x"+document.documentElement.clientHeight:window.innerWidth!=undefined&&(n.bsC=window.innerWidth+"x"+window.innerHeight),n.bsC!=""&&(n.bsC="&bs="+n.GetUrlParameter("bs",n.bsC),n.pvInfo.push(n.bsC))},HandleSession:function(){var n=Wol.Mscom,i,t,r,u;if(n.SetTime(),i="",t=document.cookie.indexOf(n.sessionCookieName+"="),t==-1){if(n.sessionId=n.currTimeAsString,n.cookieDisabled==1)return;i=n.sessionCookieName+"="+n.sessionId}else r=t+n.sessionCookieName.length+1,u=document.cookie.length,i=n.sessionCookieName+"="+document.cookie.substring(r,u);document.cookie=i,t=document.cookie.indexOf(n.sessionCookieName+"="),t==-1&&(n.cookieDisabled=1)},SetTime:function(){var n=Wol.Mscom,t=new Date;n.tz=t.getTimezoneOffset(),n.currTimeTicks=Math.max(n.currTimeTicks+1,t.getTime()),n.currTimeAsString=n.currTimeTicks.toString()},debug:function(n){Wol.Mscom.debugOn===!0&&Wol.ContentInstrumentation.Logging(n)},Pause:function(n){for(var t=new Date,i=t.getTime()+n;t.getTime()<i;)t=new Date},GetUrlParameter:function(n,t){var i=Wol.Mscom;return n in i.queryParamLength&&t.length>i.queryParamLength[n][0]&&(t=t.substring(0,i.queryParamLength[n][1])),t},ProcessClick:function(n){var t=Wol.Mscom,c=Wol.ContentInstrumentation.Logging,f,i,o,r,s,l,e,h,u,a,v;try{if(t.HandleSession(),f=n||window.event,f)for(i=f.srcElement||f.target;i.tagName&&t.IsInList(i.tagName)==!1;)i=i.parentElement||i.parentNode;if(i&&i.tagName&&c._getAttr(i,t.disableDefaultLoggingAttribute)===undefined){switch(i.tagName){case"A":o=document.all?i.innerText||"":i.text||"",t.clickInfo="&cot=1&cn="+t.GetUrlParameter("cn",t.Encode(o))+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",i.href?t.Encode(i.href):"");break;case"IMG":t.clickInfo="&cot=2&cn="+t.GetUrlParameter("cn",i.alt?t.Encode(i.alt):"")+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",t.GetImageHREF(i));break;case"AREA":t.clickInfo="&cot=3&cn="+t.GetUrlParameter("cn",i.alt?t.Encode(i.alt):"")+"&cid="+t.GetId(i)+"&ct="+t.GetUrlParameter("ct",i.href?t.Encode(i.href):"");break;case"INPUT":if(r=i.type||"",s="",r&&(r=="button"||r=="reset"||r=="submit"||r=="image"||r=="text"||r=="search")&&(f.which||f.keyCode)==13){if(l=i.value||i.name||i.alt||i.id,t.clickInfo="&cot=4&cn="+t.GetUrlParameter("cn",l?t.Encode(l):"")+"&cid="+t.GetId(i)+"&ct=",i.form)for(t.clickInfo+=t.GetUrlParameter("ct",t.Encode(i.form.action)||t.Encode(window.location.pathname)),e=i.form.elements,h=1,u=0;u<e.length;u++)a=e[u].type,a=="text"&&(s+="&t"+h+"="+t.Encode(e[u].name||e[u].id)+"&v"+h+"="+t.Encode(e[u].value),h++);else t.clickInfo+=t.GetUrlParameter("ct",t.Encode(window.location.pathname));s!=""&&(t.clickInfo+=s)}break;default:t.clickInfo=""}t.clickInfo!=""&&(v=c._getBiDataMap(null,null,i),t.customTags=t.EncodeCustomEventStr(v.GetMscomArray()),t.Beacon(),t.browserDelay>0&&t.Pause(t.browserDelay))}}catch(y){t.debug("ProcessClick:"+y)}},Beacon:function(){var n=Wol.Mscom,i,t;try{i=n.GetFullSrcParts(),t=i.join(""),t=n.EnsureBeaconSrcLength(t),n.SendBeacon(t)}catch(r){n.debug("Beacon:"+r)}},EnsureBeaconSrcLength:function(n){return n.length>2048&&(n=n.substring(0,2042),n.lastIndexOf("&")>=0&&(n=n.substring(0,n.lastIndexOf("&"))),n=n+"&tr=1"),n},SendBeacon:function(n,t){var i=Wol.Mscom,r;try{document.images?(r=document.createElement("IMG"),t&&(r.onload=t,r.onerror=t),i.imgArray[i.imgArrayIndex]=r,i.imgArray[i.imgArrayIndex].src=n,i.imgArrayIndex++,i.imgArrayIndex>i.imgArrayMax&&(i.imgArray=i.imgArray.splice(0,i.imgArrayIndex-i.imgArrayMax))):(document.write('<IMG ALT="" BORDER="0" NAME="bImg" WIDTH="1" HEIGHT="1" SRC="'+n+'"/>'),t&&setTimeout(t,250))}catch(u){i.debug("SendBeacon:"+u)}finally{i.clickInfo="",i.customInfo="",i.customTags=""}},GetBaseSrcParts:function(){var n=Wol.Mscom,t;try{return t=[],t.push(n.wedcsUriBase+"/trans_pixel.aspx?"),n.routeParams!=""&&t.push(n.routeParams),n.pvInfo.length=0,n.SetPVInfo(),t.push(n.pvInfo.join("")),t}catch(i){n.debug("GetBaseSrcParts:"+i)}},GetFullSrcParts:function(){var n=Wol.Mscom,t;try{return t=n.GetBaseSrcParts(),n.clickInfo!=""&&t.push(n.clickInfo),n.InitMeta(),n.metaTags!=""&&t.push(n.metaTags),n.customTags!=""&&t.push(n.customTags),n.customInfo!=""&&(t.push(n.customEventParam),t.push(n.customInfo)),t}catch(i){n.debug("GetFullSrcParts:"+i)}},GetBaseSrcString:function(){var n=Wol.Mscom;return n.GetBaseSrcParts().join("")},GetId:function(n){var t=Wol.Mscom;return n?n.id==undefined?"":t.GetUrlParameter("cid",t.Encode(n.id)):""},GetImageHREF:function(n){var i=Wol.Mscom,t=n;if(n){if(n=n.parentElement||n.parentNode,n&&n.tagName=="A")return n.href?i.Encode(n.href):"";if(t&&t.src)return i.Encode(t.src)}return""},ReadAllTags:function(n){for(var i=Wol.Mscom,t=[];n&&n!="undefined";)t.push(i.ReadElementTags(n)),n=n.parentElement||n.parentNode;return t.join("")},ReadClickTags:function(n){var t=Wol.Mscom,r=[],i,u;return r.push(t.ReadElementTags(n,t.clickPrefix)),i=n.parentElement||n.parentNode,typeof i!="undefined"&&i!==null&&(u=t.ReadAllTags(i)),r.join("")+u},ReadElementTags:function(n,t){var i=Wol.Mscom,e="",u,r,f;if(n)for(u in n.attributes)u!=undefined&&n.attributes[u]!=null&&n.attributes[u]!=undefined&&(r=n.attributes[u].name,r!=null&&r!=undefined&&(f=r.toLowerCase(),f.indexOf(i.tagPrefix)==0?(t!=null&&(r=i.tagPrefix+t+r.substring(i.tagPrefix.length)),e+="&"+i.Encode(r)+"="+i.Encode(n.attributes[u].value)):(f.indexOf("s.")==0||f.indexOf("wt.")==0||f.indexOf("dcs.")==0||f.indexOf("dcsext.")==0)&&(e+="&"+i.Encode(r)+"="+i.Encode(n.attributes[u].value))));return e},IsInList:function(n){var t=Wol.Mscom,i;for(i in t.clickedElements)if(t.clickedElements[i]==n.toUpperCase())return!0;return!1},setEvents:function(){var n=Wol.Mscom,t,i;n.varClickTracking!=undefined&&n.varClickTracking==1&&(document.body.addEventListener?document.body.addEventListener("click",n.ProcessClick):typeof jQuery!="undefined"?jQuery(document.body).click(n.ProcessClick):document.body.attachEvent?document.body.attachEvent("onclick",n.ProcessClick):(t=document.body.onclick,i=t?function(i){n.ProcessClick(i),t(i)}:n.ProcessClick,document.body.onclick=i))},InitMeta:function(){var n=Wol.Mscom;n.metaTags=n.GetMetaTagsStr()},GetMetaTagsStr:function(){var r=Wol.Mscom,n,f,u,i,t;if(document.all?n=document.all.tags("meta"):document.documentElement&&(n=document.getElementsByTagName("meta")),f="",typeof n!="undefined")for(u=0;u<n.length;u++)i=n.item(u),i.name&&(t=i.name.toLowerCase(),(t.indexOf(r.tagPrefix)==0||t.indexOf("s.")==0||t.indexOf("wt.")==0||t.indexOf("dcs.")==0||t.indexOf("dcsext.")==0)&&(f+="&"+r.Encode(i.name)+"="+r.Encode(i.content)));return f},Init:function(){var n=Wol.Mscom;try{n.HandleSession(),n.setEvents(),n.Beacon()}catch(t){n.debug("Mscom - Init:"+t)}},InitRoute:function(n,t,i){var r=Wol.Mscom;r.ctrlCode=n,r.routeCode=t,r.pKey=i,r.pKey&&r.pKey!==""&&r.routeCode&&r.routeCode!==""&&r.ctrlCode&&r.ctrlCode!==""&&(r.routeParams="pKey="+r.pKey+"&route="+r.routeCode+"&ctrl="+r.ctrlCode+"&")},InitFlexInfo:function(n){var t=Wol.Mscom,i;if(t.flexInfo="",n!==null&&typeof n=="object")for(i in n)t.flexInfo+="&"+t.Encode(i)+"="+t.Encode(n[i])},Encode:function(n){return typeof encodeURIComponent=="function"?encodeURIComponent(n):escape(n)}},typeof Wol=="undefined"&&(Wol={}),typeof Wol.ContentInstrumentation=="undefined"&&(Wol.ContentInstrumentation={}),typeof Wol.ContentInstrumentation.Logging=="undefined"&&(Wol.ContentInstrumentation.Logging={}),Wol.ContentInstrumentation.Logging.Rio={InitRIO:function(n,t,i,r,u,f){var e=Wol.ContentInstrumentation.Logging,p,c,w;if(typeof e!="undefined"&&(e.rioEnv=null,e.initLogging))try{var l=e._getAnnotationName(i),a="meta[name='"+l+"']",h=jQuery(a).attr("content"),v=e._getAnnotationName(r),y="meta[name='"+v+"']",o=e._getAnnotationName(u),s=jQuery(y).attr("content");s||(p=e._findBySingleAttribute(document.body,o),s=jQuery(p).first().attr(o)),h&&s&&(e.rioEnv=window.location.protocol+"//"+n+"/RioTracking2.js",jQuery.getScript(e.rioEnv,function(){typeof RioTracking!="undefined"?(RioTracking.guestCellCode=h,RioTracking.uniqueActionTagCode=s):e._logError(new Error("RIO tracking client script was downloaded, but not evaluated successfully - RioTracking namespace is not defined."))}),c=e._getAnnotationName(f),w=e._findBySingleAttribute(document.body,c),jQuery(w).click(function(){try{var t=jQuery(this),i=t.attr(c),n=t.attr(o);n||(n=t.parents().filter(function(){return typeof jQuery(this).attr(o)!="undefined"}).first().attr(o)),n||(n=s),RioTracking.clickNoWait(i,n)}catch(r){e._logError(r)}}))}catch(b){e._logError(b)}}},typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.BIPreloadDatabag=="undefined"&&(Ms.Wol.BIPreloadDatabag={}),typeof Wol=="undefined"&&(Wol={}),typeof Wol.SiteInstrumentation=="undefined"&&(Wol.SiteInstrumentation={}),Wol.SiteInstrumentation.Logging={queryStringParameters:{semid:"MS.PaidSearch"},InitCustomInstrumentation:function(){var t=Wol.SiteInstrumentation.Logging,i=t.queryStringParameters,n=window.location.search.replace(/\+/g," "),r,u;try{n=decodeURIComponent(n.substr(1))}catch(f){n=""}for(r in i)try{u=t.ParseQueryString(n,r),u!=""&&(Ms.Wol.BIPreloadDatabag[i[r]]=u)}catch(f){}},ParseQueryString:function(n,t){for(var r=n.split("&"),u,i=0;i<r.length;i++)if(u=r[i].split("="),jQuery.trim(u[0].toLowerCase())==t)return jQuery.trim(u[1]);return""}},Wol.SiteInstrumentation.Logging.InitCustomInstrumentation(),link_expandAllText=link_expandAllText?link_expandAllText:"",link_collapseAllText=link_collapseAllText?link_collapseAllText:"",function(){function h(n){var t=n.target?n.target:n.srcElement,i;if(t.attributes["class"]&&(i=t.attributes["class"].value,s.hasOwnProperty(i)&&(s[i](t,i,!0),!v(n))))return!1}function b(){var n=jQuery("a.link_expandAll"),f,e,o;jQuery.each(n,function(){u(this)===t.expand&&r(this,"link_expandAll",!1)}),f=jQuery("a.link_collapseAll"),jQuery.each(f,function(){u(this)===t.collapse&&r(this,"link_collapseAll",!1)}),e=jQuery("a.link_expand"),jQuery.each(e,function(){u(this)===t.expand&&i(this,"link_expand",!1)}),o=jQuery("a.link_collapse"),jQuery.each(o,function(){u(this)===t.collapse&&i(this,"link_collapse",!1)})}function k(n,t){if(!n||!t)return-1;if(n===t)return 0;for(var r=1,i=n.parentNode;i&&i!==document;){if(i===t)return r;r++,i=i.parentNode}return-1}function c(n,t,i){var r=k(n,t);return r<0||r>i?!1:!0}function i(t,i,r){if(t){var u=jQuery(t).closest(".link_container").parent().closest("div")[0],f=u.childNodes[1],h=u.parentNode,c=jQuery(t).closest(".link_container"),s=c.find(".link_image_container a img")[0];u&&f&&(i==="link_collapse"?(n(t,"link_expand"),n(f,"expand"),n(s,"link_image_expand"),r&&o(t)):i==="link_expand"&&(n(t,"link_collapse"),n(f,"collapse"),n(s,"link_image_collapse"),r&&e(t)),g(h))}}function l(n,t,r){if(n){var f=jQuery(n).closest(".link_container"),u=f.find("a")[1],e=u.attributes["class"].value;i(u,e,r)}}function r(t,i,r){var l,f,s,p,v,y,w,u,h,b,c,k;if(t)for(l=t.parentNode.childNodes,i==="link_expandAll"&&(n(t,"link_collapseAll"),a(t,link_collapseAllText),r&&e(t)),i==="link_collapseAll"&&(n(t,"link_expandAll"),a(t,link_expandAllText),r&&o(t)),f=0;f<l.length;f++)if((s=jQuery(l[f]).attr("class"),s)&&(s.indexOf("faqEntry")!==-1||s.indexOf("procedure")!==-1||s.indexOf("section")!==-1))for(p=l[f].childNodes,v=0;v<p.length;v++)(y=p[v],w=y.attributes["class"],w)&&(u=w.value,(u==="question"||u==="title_procedure ecTitle"||u==="title_section ecTitle")&&(h=jQuery(y).find(".link_container").children(),h&&h.length===2&&(b=jQuery(h[0]).find("a img")[0],c=jQuery(h[1]).find("a")[0],i==="link_expandAll"?(n(b,"link_image_expand"),n(c,"link_expand"),r&&o(c)):i==="link_collapseAll"&&(n(b,"link_image_collapse"),n(c,"link_collapse"),r&&e(c)))),(u==="collapse"||u==="expand")&&(k=y,i==="link_expandAll"?n(k,"expand"):i==="link_collapseAll"&&n(k,"collapse")))}function n(n,t){n&&t&&(n.attributes["class"].value=t)}function a(n,t){n&&t&&(n.innerHTML=t)}function u(n){var t=n.getAttribute(f);return t?Ms.Wol.Cookies.GetCookie(t):null}function e(n){if(n){var i=jQuery(n).attr(f);i&&Ms.Wol.Cookies.SetCookie(i,t.expand)}}function o(n){if(n){var i=jQuery(n).attr(f);i&&Ms.Wol.Cookies.SetCookie(i,t.collapse)}}function v(n){return n.preventDefault?(n.preventDefault(),!0):!1}function d(t){var r=t.target,u,i,f;if(r){for(u=r.parentNode,i=null;u&&!i;)i=u.getElementsByTagName("a")[0],u=u.parentNode;i&&(f=r.options[r.selectedIndex].value,f?(i.href=f,n(i,"hashref")):(i.removeAttribute("href"),n(i,"nohref")))}}function y(){jQuery("span.button>a").keypress(function(n){var t,i;n.which===32&&(t=Boolean(jQuery(this).attr("href")),this.onClick&&(this.onClick()||(t=!1)),t&&(this.click?this.click():(i=document.createEvent("MouseEvents"),i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.dispatchEvent(i),window.location.href=jQuery(this).attr("href")),v(n)))})}function p(){var n=jQuery("select.dropdown_select");n.change(d),jQuery.each(n,function(){jQuery(this).trigger("change")})}function g(n){if(n){var r=jQuery(n).children(".link_expandAll"),u=jQuery(n).children(".link_collapseAll"),t=jQuery(n).find("a.link_expand"),i=jQuery(n).find("a.link_collapse");t=t.filter(function(){return c(jQuery(this)[0],n,7)}),i=i.filter(function(){return c(jQuery(this)[0],n,7)}),jQuery(i).length>0?(jQuery(u).attr("class","link_expandAll"),jQuery(u).html(link_expandAllText)):jQuery(t).length>0&&(jQuery(r).attr("class","link_collapseAll"),jQuery(r).html(link_collapseAllText))}}function w(){var t=navigator.appVersion.split(";")[1]===" MSIE 6.0",n=navigator.appName==="Safari"||navigator.userAgent.indexOf("Safari")!==-1,i,r;(t||n)&&(i=jQuery("div.section_oly-bg-stretch").parent(),i.each(function(){var n=jQuery(this),t=n.children().children("img.embedObject");t.height()<n.height()&&t.height(n.height())})),n&&(r=jQuery("div.wmpObjectDownlevel"),r.each(function(){var t=jQuery(this),u=t.children("a"),i=u.children("img"),r=t.parent(),f=r.parent(),e=f.parent(),o=e.parent(),s=o.parent(),n=r.children("div.wmpObjectDiv"),h=n.children("object");s.hasClass("section_oly")&&n.size()>0&&i.height()<n.height()&&i.height(n.height())}))}var s={link_expand:i,link_collapse:i,link_expandAll:r,link_collapseAll:r,link_image_expand:l,link_image_collapse:l},f="data-id",t={expand:"e",collapse:"c"};(function(){document.attachEvent?document.attachEvent("onclick",h):document.addEventListener&&document.addEventListener("click",h,!1),jQuery(document).ready(b)})(),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(y):jQuery(document).ready(y),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(p):jQuery(document).ready(p),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"?Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(w):jQuery(document).ready(w)}(),typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),Ms.Wol.SearchBox=function(){"use strict";var r="form.SearchQuery,form.HHSearchQuery",u="div.SearchQueryBoxBackgroundLevel1,div.HHSearchQueryBoxBackgroundLevel1",i="input[type='text']",n={query:"q",allowed:["q","prd","s","osd"]};$(function(){f()}),$(window).load(function(){e()});var f=function(){var n="form.SearchQuery input[type='submit'],form.HHSearchQuery input[type='submit']",t="a.HighContrastSearchQuerySubmit,a.HHHighContrastSearchQuerySubmit";$(r).each(function(){s(this)}),$(t).css("display","inline"),$(n).css("display","none")},s=function(r){var e=!1,f=$(r),s,c,l;f.attr("data-useAsync")==="true"&&(e=!0),s=f.children(i),h(s,r)&&(s.focus(function(){o(this.backgroundBox)}).blur(function(){t(this,this.backgroundBox)}),$(r).children(u).focus(function(){o(this),$(this.inputBox).focus()}),f.submit(function(){var u,t,i,r;if(this.inputBox.value){if(e){for(u=Wol.Util.HashParameters.getHash(),t={},i=0;i<n.allowed.length;i++)r=n.allowed[i],u[r]&&(t[r]=u[r]);return t[n.query]=this.inputBox.value,location.href=this.action+"#"+Wol.Util.Tools.toUrlParams(t),!1}return!0}return!1}),e&&(c=Wol.Util.HashParameters.getHash(n.query),c&&s.each(function(){this.val=c,t(this,this.backgroundBox)})),l=function(n){n.keyCode===13&&r.inputBox.value!==""&&typeof Wol!="undefined"&&typeof Wol.ContentInstrumentation!="undefined"&&typeof Wol.ContentInstrumentation.Logging!="undefined"&&(Wol.ContentInstrumentation.Logging.FireClickTrackingEvent(n),n.preventDefault(),setTimeout(function(){f.submit()},50))},jQuery(r.inputBox).keypress(l))},e=function(){$(i).each(function(){typeof this.HasFocus!="undefined"&&this.HasFocus||typeof this.backgroundBox=="undefined"||t(this,this.backgroundBox)})},t=function(n,t){n.value===""?$(t).css("display","inline"):$(t).css("display","none")},o=function(n){$(n).css("display","none")},h=function(n,t){var r,i,f;return typeof n=="undefined"||typeof t=="undefined"?!1:(r=n.siblings(u),n.length===0||r.length===0)?!1:(i=n.get(0),f=r.get(0),t.inputBox=i,i.backgroundBox=f,f.inputBox=i,!0)};return{onReadyFunction:f,onLoadFunction:e,updateQuery:function(n){$(r).children(i).each(function(){this.value=n,t(this,this.backgroundBox)})}}}(),jQuery(document).ready(processDocumentLoaded),function(n){"use strict";n(function(){i(),typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"&&Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){i()})});var i=function(){n("div.UnresolvedVideoContainer").each(function(){u(this)}),h()},u=function(t){var i=n(t),r=i.data("video-detection"),u;if(!r)throw"The data-videoDetection attribute does not contain a valid information to resolve the video player";u=f(r),u&&i.append(u.html),i.removeClass("UnresolvedVideoContainer").addClass("VideoContainerInner"),Wol.Video&&Wol.Video.PlayerBase&&Wol.Video.PlayerBase.initialize(i[0]),Wol.Video&&Wol.Video.Hero&&Wol.Video.Hero.initialize(i[0])},f=function(n){for(var t=0,u=n.length;t<u;t++){var i=n[t],r=i.reqType,f=i.reqParam;if(!r||e(r,f))return i}return null},e=function(t,i){switch(t){case"html5player":return o(n.parseJSON(i));case"silverlightplayer":return s(i,"4.0.50401.0");default:return!1}},o=function(n){var i,t,r;try{if(i=document.createElement("video"),!i.canPlayType)return!1;for(t=0;t<n.length;t++)if(r=n[t],i.canPlayType(r)==="probably")return!0;return!1}catch(u){return!1}},s=function(t,i){try{return n.ajax({url:t,async:!1,cache:!0,dataType:"script"}),Silverlight.isInstalled(i)}catch(r){return!1}},h=function(){n("video.AutoStartImmediate").each(function(){this.addEventListener("canplay",r,!1),n(this).removeClass("AutoStartImmediate")}),n("video").not("[hasClickToPlay]").attr("hasClickToPlay","1").click(function(n){var t=60;n.which===1&&this.clientHeight-n.offsetY>t&&(this.paused||this.ended?this.play():this.pause())})},r=function(){n(this).is(":visible")&&(this.play(),this.removeEventListener("canplay",r,!1))}}(jQuery),typeof Wol=="undefined"&&(Wol={}),typeof Wol.Video=="undefined"&&(Wol.Video={}),function(n){n.fn.oneTime=function(n,t){return this.filter(function(){return this[n]!==n&&t.apply(this)!==!1?(this[n]=n,!0):!1})}}(jQuery),jQuery(function(){typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"&&Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){Wol.Video.SetupVideoLogging()}),Wol.Video.SetupVideoLogging()}),Wol.Video.SetupVideoLogging=function(){var i=function(n,t){return t>0?Math.round(10*(n/t))*10:0},n=function(n,t){var f=!1,e=!1,o=!1,r=0,u=0,s="",h=!1;return{setMediaUrl:function(n){n&&(s=n)},setStarted:function(){f=!0},setFullscreen:function(){e=!0},setClosedCaptions:function(){o=!0},setWatchTime:function(n){n!==null&&(r=n)},setWatchedDuration:function(){r=u},setDuration:function(n){n!==null&&(u=n)},notify:function(){if(!h&&typeof Wol!="undefined"&&Wol.ContentInstrumentation&&Wol.ContentInstrumentation.Logging){var c={"Video.Tech":t,"Video.Url":s,"Video.Start":f?1:0,"Video.FullScreen":e?1:0,"Video.ClosedCaption":o?1:0,"Video.Length":u,"Video.WatchTime":r,"Video.CompletionRate":i(r,u)};Wol.ContentInstrumentation.Logging.LogCustomBI("Video",c,n),h=!0}}}},t=function(n){window.addEventListener?window.addEventListener("beforeunload",n,!0):window.attachEvent&&window.attachEvent("onbeforeunload",n)};jQuery("video").oneTime("hasInitialized",function(){var r=this,i=n(this,"HTML5");i.setMediaUrl(this.src),t(function(){i.setWatchTime(r.currentTime),i.notify()}),jQuery(this).bind("canplay",function(){i.setDuration(this.duration),i.setMediaUrl(this.currentSrc)}).bind("play",function(){i.setStarted()}).bind("timeupdate",function(){i.setWatchTime(r.currentTime)}).bind("ended",function(){i.setWatchedDuration(),i.notify()}),jQuery(this).children("track").bind("cuechange",function(n){n&&n.target&&n.target.track&&n.target.track.activeCues&&n.target.track.activeCues.length>0&&i.setClosedCaptions()})});jQuery("object.VideoPlayer").oneTime("hasInitialized",function(){var u=this,r=this.playerObject,f,i;return r?(f=function(){var t=$(u).children("param[name=InitParams]").attr("value"),n={};return jQuery.each(t.split(","),function(t,i){var r=/([^=]*)=(.*)/.exec(i);r&&(n[r[1]]=r[2])}),n}(),i=n(this,"Silverlight"),i.setMediaUrl(f.mediaurl),this.onPlayerCaptionsActivated=function(){i.setClosedCaptions()},t(function(){i.setWatchTime(r.PlaybackPositionSeconds),i.notify()}),r.addEventListener("FullScreenChanged",function(){i.setFullscreen()}),r.addEventListener("PlayStateChanged",function(n,t){t&&t.Result==="Playing"&&i.setStarted()}),r.addEventListener("MediaOpened",function(n){i.setDuration(n.EndPositionSeconds)}),r.addEventListener("MediaEnded",function(){i.setWatchedDuration(),i.notify()}),!0):!1})},window.CanvasHelper||(window.CanvasHelper={}),CanvasHelper.initCanvas=function(n,t,i,r,u){var f=document.getElementById(n),e=document.getElementById(t);CanvasHelper.isCanvasSupported()?(jQuery(f).show(),jQuery(e).hide(),i(r,u)):(jQuery(e).show(),jQuery(f).hide())},CanvasHelper.isCanvasSupported=function(){var n=document.createElement("canvas");return!!(n.getContext&&n.getContext("2d"))},typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.IFrame=="undefined"&&(Ms.Wol.IFrame={}),Ms.Wol.IFrame.AddFrameBorder=function(){jQuery("iframe.iframeNoBorder").attr("frameborder","0")},jQuery(document).ready(Ms.Wol.IFrame.AddFrameBorder),typeof Hub=="undefined"&&(Hub={}),typeof Hub.PostProcessFunctionList=="undefined"&&(Hub.PostProcessFunctionList=[]),Hub.PostProcessData=function(){if(typeof Hub.PostProcessFunctionList=="object")for(var n=0;n<Hub.PostProcessFunctionList.length;n++)postProcessFunction=Hub.PostProcessFunctionList[n],typeof postProcessFunction=="function"&&postProcessFunction()},Hub.AddPostProcessFunction=function(n){typeof n=="function"&&Hub.PostProcessFunctionList.push(n)},SearchBoxPostProcessEvent=function(){var n="div.HHSearchQuery";jQuery(jQuery(n).get(0)).focus(),Ms.Wol.SearchBox.onReadyFunction(),Ms.Wol.SearchBox.onLoadFunction()},FeedbackControlPolicyPostProcessEvent=function(){window.external&&(window.external.NoExplicitFeedback||window.external.NoImplicitFeedback)&&jQuery("div").remove("#feedbackControlBody")},Hub.AddPostProcessFunction(SearchBoxPostProcessEvent),Hub.AddPostProcessFunction(FeedbackControlPolicyPostProcessEvent);